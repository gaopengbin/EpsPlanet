!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/common/http"),require("@angular/core"),require("@angular/forms"),require("epsgis"),require("ng-zorro-antd/icon"),require("ng-zorro-antd/input"),require("ng-zorro-antd/input-number"),require("ng-zorro-antd/tree"),require("ng-zorro-antd/tree-view"),require("ng-zorro-antd/popover"),require("ng-zorro-antd/divider"),require("ng-zorro-antd/select"),require("ng-zorro-antd/button"),require("ng-zorro-antd/menu"),require("ng-zorro-antd/dropdown"),require("ng-zorro-antd/grid"),require("ng-zorro-antd/slider"),require("ng-zorro-antd/tabs"),require("ng-zorro-antd/modal"),require("ng-zorro-antd/table"),require("ng-zorro-antd/switch"),require("ng-zorro-antd/tooltip"),require("ng-zorro-antd/form"),require("lodash"),require("ng-zorro-antd/core/transition-patch"),require("ng-zorro-antd/core/wave"),require("turf")):"function"==typeof define&&define.amd?define("epsplanet",["exports","@angular/common","@angular/common/http","@angular/core","@angular/forms","epsgis","ng-zorro-antd/icon","ng-zorro-antd/input","ng-zorro-antd/input-number","ng-zorro-antd/tree","ng-zorro-antd/tree-view","ng-zorro-antd/popover","ng-zorro-antd/divider","ng-zorro-antd/select","ng-zorro-antd/button","ng-zorro-antd/menu","ng-zorro-antd/dropdown","ng-zorro-antd/grid","ng-zorro-antd/slider","ng-zorro-antd/tabs","ng-zorro-antd/modal","ng-zorro-antd/table","ng-zorro-antd/switch","ng-zorro-antd/tooltip","ng-zorro-antd/form","lodash","ng-zorro-antd/core/transition-patch","ng-zorro-antd/core/wave","turf"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).epsplanet={},e.ng.common,e.ng.common.http,e.ng.core,e.ng.forms,e.epsgis,e.i1$1,e.input,e.i6,e.i2,e.treeView,e.i1$3,e.i4$2,e.select,e.i4$1,e.menu,e.i1$2,e.i3,e.i4,e.i2$3,e.modal,e.i5$2,e._switch,e.tooltip,e.form,e.lodash,e.i2$1,e.i5$1,e.turf)}(this,(function(e,t,n,o,i,r,a,l,s,c,p,u,m,d,g,h,f,v,y,C,z,w,M,b,P,x,S,I,T){"use strict";function N(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var O=N(T),E=function(e,t){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function j(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}Object.create;function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function k(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}var F,D;Object.create;function V(e){return{title:e,children:[]}}function B(t,n,o){var i={czmObject:null};switch(t.toLocaleLowerCase()){case e.LayerType.Imagery.toLocaleLowerCase():i.czmObject=function(t,n){return{xbsjType:e.LayerType.Imagery,name:t,enable:!0,show:!0,xbsjImageryProvider:{XbsjImageryProvider:{url:n}}}}(n,o);break;case e.LayerType.Tileset.toLocaleLowerCase():i.czmObject=function(t,n){return{xbsjType:e.LayerType.Tileset,name:t,url:n,enable:!0,show:!0}}(n,o);break;case e.LayerType.Terrain.toLocaleLowerCase():i.czmObject=function(t,n){return{xbsjType:e.LayerType.Terrain,name:t,enable:!0,show:!0,xbsjTerrainProvider:{type:"XbsjCesiumTerrainProvider",XbsjEllipsoidTerrainProvider:{},XbsjCesiumTerrainProvider:{url:n,requestVertexNormals:!0,requestWaterMask:!0}}}}(n,o)}return i}(F=e.LayerType||(e.LayerType={})).Imagery="Imagery",F.Tileset="Tileset",F.Terrain="Terrain",(D=e.LayerServiceSource||(e.LayerServiceSource={}))[D.ArcGis=0]="ArcGis",D[D.SuperMap=1]="SuperMap",D[D.TianDiTu=2]="TianDiTu",D[D.BaiDu=3]="BaiDu",D[D.GaoDe=4]="GaoDe",D[D.EpsPlanet=5]="EpsPlanet";var G=function(){function e(){}return e.SceneTree2NgZorroTree=function(t){var n;if(!t||!t.children||t.children.length<=0)return t;var o=null;t.title&&"未命名"!==t.title&&((o=new c.NzTreeNode({title:t.title,expanded:!0===t.expand,key:t.guid||t.xbsjGuid||r.IdGenerater.newGuid(),origin:t,isLeaf:!1,parentNode:null})).level=-1);var i=[];return o?((n=o.children).push.apply(n,k(e.convertChildren(t.children,o))),i.push(o)):i.push.apply(i,k(e.convertChildren(t.children,o))),i},e.convertChildren=function(t,n){if(!t||t.length<=0)return[];var o=[];return t.forEach((function(t){var i,a=null;if(t.children){(a=new c.NzTreeNode({level:n.level+1,title:t.title,isExpanded:!0===t.expand,key:t.guid||t.xbsjGuid||r.IdGenerater.newGuid(),origin:t,isLeaf:!1,parentNode:n})).parentNode=n,a.level=n.level+1,a.isExpanded=!!t.expand,t.children.length>=1&&(i=a.children).push.apply(i,k(e.convertChildren(t.children,a)));var l=[];a.children.forEach((function(e){e.children&&e.children.length>0?l.push(e.isChecked):e.origin.origin.show?l.push(!0):l.push(!1)})),e.isAllEqual(l)&&1==l[0]?a.isChecked=!0:e.isAllEqual(l)&&0==l[0]?a.isChecked=!1:e.isAllEqual(l)||(a.isHalfChecked=!0),o.push(a)}else{var s=e.convertCzmObject(t.czmObject,n);s.parentNode=s.origin.parentNode,s.level=s.parentNode.level+1,o.push(s)}})),o},e.isAllEqual=function(e){return!(e.length>0)||!e.some((function(t,n){return t!==e[0]}))},e.convertCzmObject=function(e,t){return e?new c.NzTreeNode({title:e.name,key:e.guid||e.xbsjGuid||r.IdGenerater.newGuid(),origin:e,isLeaf:!0,checked:e.show,parentNode:t}):null},e.GetXbsjCzmObject=function(e){return e&&e.origin&&e.origin.origin},e.loadLayers=function(t){if(!t)return null;if(!t.basemaps&&!t.layers)return null;var n=[{title:"basemap",ref:"basemap",children:[]},{title:"layerlist",ref:"layerlist",children:[]},{tilte:"pin",ref:"pin",children:[]}];return"object"==typeof t.basemaps&&x.isArray(t.basemaps)&&t.basemaps.forEach((function(t){n[0].children.push(e.loadLayerNode(t))})),"object"==typeof t.layers&&x.isArray(t.layers)&&t.layers.forEach((function(t){n[1].children.push(e.loadLayerNode(t))})),{children:n}},e.loadLayerNode=function(t){if(x.isArray(t.children)){var n=V(t.title);return t.children&&t.children.length>=1&&t.children.forEach((function(t){n.children.push(e.loadLayerNode(t))})),n.expand=t.expand,n}if(t.url||t.layer){var o=B(t.type,t.title,t.url);return o.czmObject.xbsjGuid=t.guid,o.czmObject.show=!!t.show,o.ref=t.ref,o.czmObject.hasOwnProperty("xbsjImageryProvider")?(t.srcCoordType&&(o.czmObject.xbsjImageryProvider.XbsjImageryProvider.srcCoordType=t.srcCoordType),t.dstCoordType&&(o.czmObject.xbsjImageryProvider.XbsjImageryProvider.dstCoordType=t.dstCoordType)):o.czmObject.hasOwnProperty("xbsjTerrainProvider")||o.hasOwnProperty("url"),t.extendOptions&&(o.czmObject=Object.assign(o.czmObject,t.extendOptions)),o}return null},e}(),R=["earthContainer"];function X(e,t){}e.PlanetEarthComponent=function(e){function t(t){var n=e.call(this,t)||this;return n.componentLoader=t,n.resources=["XbsjEarth/XbsjEarth.js"],n}return L(t,e),t.getCompInfo=function(){return{name:"PlanetEarthComponent",path:"epsplanet/components/earth"}},t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this),this.is3D=!0},t.prototype.initMap=function(){var e=this;return this.is3D=!0,new Promise((function(t,n){var o=e.appConfig.map.jsApi;if(o){var i=[];e.resources.forEach((function(e){i.push(o+"/"+e)})),r.simpleLoader.loadResources(i,null,null,(function(){var o=window.XE;o?o.ready().then((function(){var n,i=new o.Earth("earthContainer",{homeButton:!0,timeline:!1,sceneModePicker:!0});i.interaction.picking.enabled=!1,i.interaction.picking.hoverEnable=!1;var r=G.loadLayers(e.config).children;if(console.log(r),(n=i.sceneTree.root.children).push.apply(n,k(r)),i.camera.navigator.showCompass=!0,i.camera.navigator.showDistanceLegend=!0,window.earth=i,i.getCurrentView=function(){var e=Cesium.Math.toDegrees,t=e(i.czm.camera.positionCartographic.longitude).toFixed(5),n=e(i.czm.camera.positionCartographic.latitude).toFixed(5),o=i.czm.camera.positionCartographic.height.toFixed(5),r=e(i.czm.camera.heading).toFixed(5),a=e(i.czm.camera.pitch).toFixed(5),l=e(i.czm.camera.roll).toFixed(5);console.log('"center":['+t+",\n"+n+",\n"+o+'],\n"heading":'+r+',\n"pitch":'+a+',\n"roll":'+l)},e.config.mapOptions&&e.config.mapOptions.center){var a=116.26984645340727,l=40.10171604578351,s=230,c=0,p=0;e.config.mapOptions.center.length>=1&&(a=e.config.mapOptions.center[0]),e.config.mapOptions.center.length>=2&&(l=e.config.mapOptions.center[1]),e.config.mapOptions.center.length>=3&&(s=e.config.mapOptions.center[2]),e.config.mapOptions.heading&&(c=e.config.mapOptions.heading),e.config.mapOptions.pitch&&(p=e.config.mapOptions.pitch),i.czm.viewer.scene.camera.setView({destination:Cesium.Cartesian3.fromDegrees(a,l,s),orientation:{heading:Cesium.Math.toRadians(c),pitch:Cesium.Math.toRadians(p),roll:0}})}t(i)})):n("XE undefined")}))}else n("没有配置jsApi")}))},t}(r.BaseMapComponent),e.PlanetEarthComponent.ɵfac=function(t){return new(t||e.PlanetEarthComponent)(o.ɵɵdirectiveInject(r.ComponentLoaderService))},e.PlanetEarthComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetEarthComponent,selectors:[["epsgis-planet-earth"]],viewQuery:function(e,t){if(1&e&&o.ɵɵviewQuery(R,3),2&e){var n;o.ɵɵqueryRefresh(n=o.ɵɵloadQuery())&&(t.earthContainer=n.first)}},features:[o.ɵɵInheritDefinitionFeature],decls:3,vars:0,consts:[["id","earthContainer",1,"earthContainer"],["earthContainer",""],["component-host",""]],template:function(e,t){1&e&&(o.ɵɵelement(0,"div",0,1),o.ɵɵtemplate(2,X,0,0,"ng-template",2))},directives:[r.ComponentContainerDirective],styles:[".earthContainer[_ngcontent-%COMP%]{width:100%;height:100%;background:grey}"]}),e.PlanetEarthComponent=j([r.ComponentRegister({uri:"epsgis-planet-earth",path:"epsplanet/components/earth",name:"PlanetEarthComponent"})],e.PlanetEarthComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetEarthComponent,[{type:o.Component,args:[{selector:"epsgis-planet-earth",templateUrl:"./earth.component.html",styleUrls:["./earth.component.scss"]}]}],(function(){return[{type:r.ComponentLoaderService}]}),{earthContainer:[{type:o.ViewChild,args:["earthContainer",{static:!0}]}]});var $=function(e){function t(){var t=e.call(this)||this;return t._isVue=!0,t.watchers=[],t}return L(t,e),t.prototype.getCesiumView=function(){return this.view?this.view.czm.viewer:null},t.prototype.$watch=function(e,t,n){this.watchers.push(r.PropWatcher.watch(this,e,(function(e,n,o){t.call(t)})))},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this),this.watchers&&this.watchers.length>=1&&this.watchers.forEach((function(e){return e.call(e)})),this.watchers.length=0},t}(r.BaseWidgetComponent);$.ɵfac=function(e){return new(e||$)},$.ɵdir=o.ɵɵdefineDirective({type:$,features:[o.ɵɵInheritDefinitionFeature]}),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata($,[{type:o.Directive}],(function(){return[]}),null),e.PlanetHomeComponent=function(e){function t(){return e.call(this)||this}return L(t,e),t.getCompInfo=function(){return{path:"epsplanet/components/home"}},t.prototype.ngOnInit=function(){this.view.czm.viewer.homeButton._container.hidden=!0},t.prototype.onMouseClick=function(e){this.view.czm.viewer.homeButton._element.click()},t}($),e.PlanetHomeComponent.ɵfac=function(t){return new(t||e.PlanetHomeComponent)},e.PlanetHomeComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetHomeComponent,selectors:[["epsgis-planet-home"]],hostAttrs:["title","home"],hostVars:2,hostBindings:function(e,t){1&e&&o.ɵɵlistener("click",(function(e){return t.onMouseClick(e)})),2&e&&o.ɵɵclassProp("jimu-widget-onscreen-icon",!0)},features:[o.ɵɵInheritDefinitionFeature],decls:1,vars:1,consts:[["nz-icon","",3,"nzIconfont"]],template:function(e,t){1&e&&o.ɵɵelement(0,"i",0),2&e&&o.ɵɵproperty("nzIconfont","icon-epsgis-home")},directives:[a.NzIconDirective,S.ɵNzTransitionPatchDirective],encapsulation:2}),e.PlanetHomeComponent=j([r.ComponentRegister({uri:"epsgis-planet-home",path:"epsplanet/components/home",name:"PlanetHomeComponent"})],e.PlanetHomeComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetHomeComponent,[{type:o.Component,args:[{selector:"epsgis-planet-home",template:"<i  nz-icon [nzIconfont]=\"'icon-epsgis-home'\"> </i>",host:{"[class.jimu-widget-onscreen-icon]":"true",title:"home"}}]}],(function(){return[]}),{onMouseClick:[{type:o.HostListener,args:["click",["$event"]]}]});var q=function(){return{marginLeft:"16px"}};function H(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-row"),o.ɵɵelementStart(1,"nz-col",3),o.ɵɵelementStart(2,"span"),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"nz-col",4),o.ɵɵelementStart(5,"nz-slider",5),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var i=t.$implicit;return o.ɵɵnextContext(2).selectedNode.origin[i.en]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(6,"nz-col",6),o.ɵɵelementStart(7,"nz-input-number",7),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var i=t.$implicit;return o.ɵɵnextContext(2).selectedNode.origin[i.en]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=t.$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(3),o.ɵɵtextInterpolate(i.zh),o.ɵɵadvance(2),o.ɵɵproperty("nzMin",0)("nzMax",1)("nzStep",.01)("ngModel",r.selectedNode.origin[i.en]),o.ɵɵadvance(2),o.ɵɵproperty("nzMin",0)("nzMax",1)("nzStep",.01)("ngStyle",o.ɵɵpureFunction0(10,q))("ngModel",r.selectedNode.origin[i.en])}}function W(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",1),o.ɵɵtemplate(1,H,8,11,"nz-row",2),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngForOf",n.config.basemapSchema)}}function A(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",4),o.ɵɵelementStart(1,"nz-slider",5),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en][1]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",1)("nzStep",.01)("ngModel",r.selectedNode.origin[i.en][1])}}function Z(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",4),o.ɵɵelementStart(1,"nz-slider",5),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en][0]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",1)("nzStep",.01)("ngModel",r.selectedNode.origin[i.en][0])}}function U(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",4),o.ɵɵelementStart(1,"nz-slider",5),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",256)("nzStep",1)("ngModel",r.selectedNode.origin[i.en])}}function J(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",4),o.ɵɵelementStart(1,"nz-slider",5),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",5)("nzStep",.01)("ngModel",r.selectedNode.origin[i.en])}}function Y(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",6),o.ɵɵelementStart(1,"nz-input-number",7),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en][1]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",1)("nzStep",.01)("ngStyle",o.ɵɵpureFunction0(5,q))("ngModel",r.selectedNode.origin[i.en][1])}}function Q(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",6),o.ɵɵelementStart(1,"nz-input-number",7),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en][0]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",1)("nzStep",.01)("ngStyle",o.ɵɵpureFunction0(5,q))("ngModel",r.selectedNode.origin[i.en][0])}}function K(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",6),o.ɵɵelementStart(1,"nz-input-number",7),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",256)("nzStep",1)("ngStyle",o.ɵɵpureFunction0(5,q))("ngModel",r.selectedNode.origin[i.en])}}function ee(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"nz-col",6),o.ɵɵelementStart(1,"nz-input-number",7),o.ɵɵlistener("ngModelChange",(function(e){o.ɵɵrestoreView(n);var t=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(2).selectedNode.origin[t.en]=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("nzMin",0)("nzMax",5)("nzStep",.01)("ngStyle",o.ɵɵpureFunction0(5,q))("ngModel",r.selectedNode.origin[i.en])}}function te(e,t){if(1&e&&(o.ɵɵelementStart(0,"nz-row"),o.ɵɵelementStart(1,"nz-col",3),o.ɵɵelementStart(2,"span"),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵtemplate(4,A,2,4,"nz-col",8),o.ɵɵtemplate(5,Z,2,4,"nz-col",8),o.ɵɵtemplate(6,U,2,4,"nz-col",8),o.ɵɵtemplate(7,J,2,4,"nz-col",8),o.ɵɵtemplate(8,Y,2,6,"nz-col",9),o.ɵɵtemplate(9,Q,2,6,"nz-col",9),o.ɵɵtemplate(10,K,2,6,"nz-col",9),o.ɵɵtemplate(11,ee,2,6,"nz-col",9),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(3),o.ɵɵtextInterpolate(n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","镜面强度"==n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","散射强度"==n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","显示精度"==n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","材质底色"==n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","镜面强度"==n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","散射强度"==n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","显示精度"==n.zh),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","材质底色"==n.zh)}}function ne(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",1),o.ɵɵtemplate(1,te,12,9,"nz-row",2),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngForOf",n.config.tilesSchema)}}function oe(e,t){if(1&e&&(o.ɵɵelementStart(0,"span"),o.ɵɵelementStart(1,"span",6),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext().$implicit;o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.title)}}function ie(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"span",7),o.ɵɵelementStart(1,"span",6),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"i",8),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext().setting(e)})),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"i",9),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext().flyTo(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext().$implicit;o.ɵɵadvance(2),o.ɵɵtextInterpolate(i.title),o.ɵɵadvance(1),o.ɵɵproperty("nzIconfont","icon-epsgis-setting"),o.ɵɵadvance(1),o.ɵɵproperty("nzIconfont","icon-epsgis-wodeweizhi1")}}function re(e,t){if(1&e&&(o.ɵɵelementStart(0,"span",3),o.ɵɵtemplate(1,oe,3,1,"span",4),o.ɵɵtemplate(2,ie,5,3,"span",5),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!n.isLeaf),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",n.isLeaf)}}function ae(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"span"),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"nz-input-number",3),o.ɵɵlistener("ngModelChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().ZValue=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=o.ɵɵnextContext();o.ɵɵadvance(2),o.ɵɵtextInterpolate(i.item.Z.label),o.ɵɵadvance(1),o.ɵɵproperty("ngModel",i.ZValue)("nzStep",1)("nzPlaceHolder",i.item.Z.placeHolder)}}function le(e,t){1&e&&(o.ɵɵelementContainerStart(0),o.ɵɵnamespaceSVG(),o.ɵɵelementStart(1,"svg",4),o.ɵɵelement(2,"path",5),o.ɵɵelementEnd(),o.ɵɵelementContainerEnd())}function se(e,t){1&e&&(o.ɵɵelementContainerStart(0),o.ɵɵnamespaceSVG(),o.ɵɵelementStart(1,"svg",4),o.ɵɵelement(2,"path",6),o.ɵɵelementEnd(),o.ɵɵelementContainerEnd())}function ce(e,t){1&e&&(o.ɵɵelementContainerStart(0),o.ɵɵnamespaceSVG(),o.ɵɵelementStart(1,"svg",4),o.ɵɵelement(2,"path",7),o.ɵɵelementEnd(),o.ɵɵelementContainerEnd())}function pe(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",8),o.ɵɵelementStart(1,"div",9),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().changeViewMode("3d")})),o.ɵɵnamespaceSVG(),o.ɵɵelementStart(2,"svg",10),o.ɵɵelement(3,"path",5),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵnamespaceHTML(),o.ɵɵelementStart(4,"div",9),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().changeViewMode("2d")})),o.ɵɵnamespaceSVG(),o.ɵɵelementStart(5,"svg",10),o.ɵɵelement(6,"path",6),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵnamespaceHTML(),o.ɵɵelementStart(7,"div",9),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().changeViewMode("columbus")})),o.ɵɵnamespaceSVG(),o.ɵɵelementStart(8,"svg",10),o.ɵɵelement(9,"path",7),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}}function ue(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"li",5),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=t.$implicit;return o.ɵɵnextContext().selectImage(e)})),o.ɵɵelementStart(1,"div",6),o.ɵɵelement(2,"img",7),o.ɵɵelement(3,"br"),o.ɵɵelementStart(4,"span",8),o.ɵɵtext(5),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=t.$implicit;o.ɵɵadvance(2),o.ɵɵproperty("src",i.imgUrl,o.ɵɵsanitizeUrl),o.ɵɵadvance(2),o.ɵɵproperty("title",i.title),o.ɵɵadvance(1),o.ɵɵtextInterpolate(i.title)}}function me(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"li",5),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=t.$implicit;return o.ɵɵnextContext().selectTerrain(e)})),o.ɵɵelementStart(1,"div",6),o.ɵɵelement(2,"img",7),o.ɵɵelement(3,"br"),o.ɵɵelementStart(4,"span",8),o.ɵɵtext(5),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var i=t.$implicit;o.ɵɵadvance(2),o.ɵɵproperty("src",i.imgUrl,o.ɵɵsanitizeUrl),o.ɵɵadvance(2),o.ɵɵproperty("title",i.czmObject.name),o.ɵɵadvance(1),o.ɵɵtextInterpolate(i.czmObject.name)}}function de(e,t){if(1&e&&(o.ɵɵelementStart(0,"span"),o.ɵɵelementStart(1,"span",11),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext().$implicit;o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.title)}}function ge(e,t){if(1&e&&(o.ɵɵelementStart(0,"span"),o.ɵɵelementStart(1,"span",11),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext().$implicit;o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.title)}}function he(e,t){if(1&e&&(o.ɵɵelementStart(0,"span",9),o.ɵɵtemplate(1,de,3,1,"span",10),o.ɵɵtemplate(2,ge,3,1,"span",10),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!n.isLeaf),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",n.isLeaf)}}e.PlanetLayerManagerComponent=function(e){function t(t){var n=e.call(this)||this;return n.nzContextMenuService=t,n.config={basemapSchema:[{en:"alpha",zh:"透明度"},{en:"brightness",zh:"亮度"},{en:"saturation",zh:"饱和度"},{en:"contrast",zh:"对比度"},{en:"hue",zh:"色相"},{en:"gamma",zh:"伽马"}],tilesSchema:[{en:"maximumScreenSpaceError",zh:"显示精度"},{en:"imageBasedLightingFactor",zh:"散射强度"},{en:"luminanceAtZenith",zh:"材质底色"},{en:"imageBasedLightingFactor",zh:"镜面强度"}]},n.layerNodes=[],n}return L(t,e),t.prototype.openFolder=function(e){if(console.log(e),e instanceof c.NzTreeNode)e.isExpanded=!e.isExpanded;else{var t=e.node;t&&(t.isExpanded=!t.isExpanded)}},t.prototype.activeNode=function(e){this.activatedNode=e.node},t.prototype.contextMenu=function(e,t){this.nzContextMenuService.create(e,t)},t.prototype.selectDropdown=function(){},t.getCompInfo=function(){return{name:"PlanetLayerManagerComponent",path:"epsplanet/components/layer-manager"}},t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},t.prototype.loadlocate=function(){var e,t,n,o,i=this;(new XE.Tool.WMTSParser).parser("http://jojo1986.f3322.net:8888/geoserver/gwc/service/wmts?REQUEST=GetCapabilities").then((function(r){var a;(console.log(r),!1,r,0==r.length)?console.log("server has no supproted layers","warning"):(e=r[0],console.log(e.rectangle),t=e.urls[0].format,n=e.styles[0].id,o=e.tileMatrixSets[0],i.view.sceneTree.root.children.push({czmObject:{xbsjType:"Imagery",name:e.title,xbsjImageryProvider:{XbsjImageryProvider:{},UrlTemplateImageryProvider:{},WebMapTileServiceImageryProvider:{url:e.urls[0].template,format:t,layer:e.title,style:n,tileMatrixSetID:o.tileMatrixSetID,tileMatrixLabels:o.params.tileMatrixLabels,tilingScheme:o.params.tilingScheme,maximumLevel:o.maximumLevel},createTileMapServiceImageryProvider:{},type:"WebMapTileServiceImageryProvider"}}}),window.earth.czm.viewer.camera.flyTo({destination:(a=Cesium.Rectangle).fromDegrees.apply(a,k(e.rectangle))}))})).catch((function(e){!1,console.log("GetCapabilities failed:"+e.message,"error")}))},t.prototype.test=function(){var e=this;setTimeout((function(){console.log(e.selectedNode)}),100)},t.prototype.onDblClickNode=function(e){console.log(e.node.origin.origin)},t.prototype.onCheckedChange=function(e){"check"===e.eventName&&e.node&&(e.node.isChecked?G.GetXbsjCzmObject(e.node).show=!0:G.GetXbsjCzmObject(e.node).show=!1)},t.prototype.onRightClick=function(e){},t.prototype.ngAfterViewInit=function(){e.prototype.ngAfterViewInit.call(this)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t}($),e.PlanetLayerManagerComponent.ɵfac=function(t){return new(t||e.PlanetLayerManagerComponent)(o.ɵɵdirectiveInject(f.NzContextMenuService))},e.PlanetLayerManagerComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetLayerManagerComponent,selectors:[["epsgis-planet-layer-manager"]],inputs:{selectedNode:"selectedNode",type:"type"},features:[o.ɵɵInheritDefinitionFeature],decls:2,vars:2,consts:[["class","schema",4,"ngIf"],[1,"schema"],[4,"ngFor","ngForOf"],["nzSpan","4"],["nzSpan","14"],[3,"nzMin","nzMax","nzStep","ngModel","ngModelChange"],["nzSpan","2"],[3,"nzMin","nzMax","nzStep","ngStyle","ngModel","ngModelChange"],["nzSpan","14",4,"ngIf"],["nzSpan","2",4,"ngIf"]],template:function(e,t){1&e&&(o.ɵɵtemplate(0,W,2,1,"div",0),o.ɵɵtemplate(1,ne,2,1,"div",0)),2&e&&(o.ɵɵproperty("ngIf","影像"==t.type),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","影像"!==t.type))},directives:[t.NgIf,t.NgForOf,v.NzRowDirective,v.NzColDirective,y.NzSliderComponent,i.NgControlStatus,i.NgModel,s.NzInputNumberComponent,t.NgStyle],styles:["nz-row[_ngcontent-%COMP%]{font-size:10px}nz-input-number[_ngcontent-%COMP%]{width:70px;height:30px}"]}),e.PlanetLayerManagerComponent=j([r.ComponentRegister({uri:"epsgis-planet-layer-manager",path:"epsplanet/components/layer-manager",name:"PlanetLayerManagerComponent"})],e.PlanetLayerManagerComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetLayerManagerComponent,[{type:o.Component,args:[{selector:"epsgis-planet-layer-manager",templateUrl:"./layer-manager.component.html",styleUrls:["./layer-manager.component.scss"]}]}],(function(){return[{type:f.NzContextMenuService}]}),{selectedNode:[{type:o.Input}],type:[{type:o.Input}]}),e.PlanetLayerListComponent=function(t){function n(e){var n=t.call(this)||this;return n.modalService=e,n.testnode=[{title:"parent 0",key:"100",author:"NG ZORRO",children:[{title:"leaf 0-0",key:"1000",author:"NG ZORRO"},{title:"leaf 0-1",key:"1001",author:"NG ZORRO",isLeaf:!0}]},{title:"parent 1",key:"101",author:"NG ZORRO",children:[{title:"leaf 1-0",key:"1010",author:"NG ZORRO",isLeaf:!0},{title:"leaf 1-1",key:"1011",author:"NG ZORRO",isLeaf:!0}]}],n.layerNodes=[],n.listOfData=[],n.isShow=!1,n}return L(n,t),n.getCompInfo=function(){return{name:"PlanetLayerListComponent",path:"epsplanet/components/layer-list"}},n.prototype.ngOnInit=function(){var e=this;XE.MVVM.watch((function(){return k(e.view.sceneTree.root.children)}),(function(){e.loadSceneTree()}))},n.prototype.openFolder=function(e){if(console.log(e),e instanceof c.NzTreeNode)e.isExpanded=!e.isExpanded;else{var t=e.node;t&&(t.isExpanded=!t.isExpanded)}},n.prototype.loadSceneTree=function(){var e=this;setTimeout((function(){var t=G.SceneTree2NgZorroTree(e.view.sceneTree.$refs.layerlist);e.layerNodes=t[0].children}),100)},n.prototype.setting=function(t){this.selectedNode=t.origin,this.type=this.selectedNode.origin.hasOwnProperty("luminanceAtZenith")?"瓦片":"影像",this.isShow=!0,this.modalService.create({title:"图层“"+t.title+"”参数",content:e.PlanetLayerManagerComponent,componentParams:{selectedNode:this.selectedNode,type:this.type},footer:null,mask:!1,width:320})},n.prototype.flyTo=function(e){e.origin.origin.flyTo()},n.prototype.onLeftClickNode=function(e){console.log(e.node),this.selectedNode=e.node.origin},n.prototype.onCheckedChange=function(e){console.log(e),"check"===e.eventName&&e.node&&this.showOrHideLayer(e.node)},n.prototype.showOrHideLayer=function(e){var t=this;e.children&&0!=e.children.length?e.children.forEach((function(e){t.showOrHideLayer(e)})):e.isChecked?G.GetXbsjCzmObject(e).show=!0:G.GetXbsjCzmObject(e).show=!1},n.prototype.onDblClickNode=function(e){"dblclick"===e.eventName&&e.node&&G.GetXbsjCzmObject(e.node).flyTo()},n.prototype.onRightClick=function(e){},n}($),e.PlanetLayerListComponent.ɵfac=function(t){return new(t||e.PlanetLayerListComponent)(o.ɵɵdirectiveInject(r.ModalManagerService))},e.PlanetLayerListComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetLayerListComponent,selectors:[["epsgis-planet-layer-list"]],features:[o.ɵɵInheritDefinitionFeature],decls:4,vars:2,consts:[["nzBlockNode","","nzCheckable","",3,"nzData","nzTreeTemplate","nzClick","nzDblClick","nzCheckBoxChange","nzContextMenu"],["nzTreeComponent",""],["nzTreeTemplate",""],[1,"custom-node"],[4,"ngIf"],["class","leaf",4,"ngIf"],[1,"folder-name"],[1,"leaf"],["title","参数调整","nz-icon","",2,"float","right",3,"nzIconfont","click"],["title","缩放至","nz-icon","",2,"float","right",3,"nzIconfont","click"]],template:function(e,t){if(1&e&&(o.ɵɵelementStart(0,"nz-tree",0,1),o.ɵɵlistener("nzClick",(function(e){return t.onLeftClickNode(e)}))("nzDblClick",(function(e){return t.onDblClickNode(e)}))("nzCheckBoxChange",(function(e){return t.onCheckedChange(e)}))("nzContextMenu",(function(e){return t.onRightClick(e)})),o.ɵɵelementEnd(),o.ɵɵtemplate(2,re,3,2,"ng-template",null,2,o.ɵɵtemplateRefExtractor)),2&e){var n=o.ɵɵreference(3);o.ɵɵproperty("nzData",t.layerNodes)("nzTreeTemplate",n)}},directives:[c.NzTreeComponent,t.NgIf,a.NzIconDirective,S.ɵNzTransitionPatchDirective],styles:["i[_ngcontent-%COMP%]{font-size:16px;margin-right:5px}i[_ngcontent-%COMP%]:hover{font-size:20px}  .sspanel_content{overflow:overlay!important}  .leaf .ant-tree-checkbox-inner{left:30px}"]}),e.PlanetLayerListComponent=j([r.ComponentRegister({uri:"epsgis-planet-layer-list",path:"epsplanet/components/layer-list",name:"PlanetLayerListComponent"})],e.PlanetLayerListComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetLayerListComponent,[{type:o.Component,args:[{selector:"epsgis-planet-layer-list",templateUrl:"./layer-list.component.html",styleUrls:["./layer-list.component.scss"]}]}],(function(){return[{type:r.ModalManagerService}]}),null),e.PlanetLocationComponent=function(e){function t(){var t=e.call(this)||this;return t.XValue=0,t.YValue=0,t.ZValue=0,t.item4326={X:{label:"经度：",min:"-180",max:"180",placeHolder:"请输入经度"},Y:{label:"纬度：",min:"-90",max:"90",placeHolder:"请输入纬度"},Z:{label:"高度：",placeHolder:"请输入高度"}},t.itemOther={X:{label:"X：",min:"-99999999",max:"99999999",placeHolder:"请输入横坐标"},Y:{label:"Y：",min:"-99999999",max:"99999999",placeHolder:"请输入纵坐标"}},t.item=t.item4326,t}return L(t,e),t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this),this.initialize()},t.getCompInfo=function(){return{path:"epsplanet/components/location"}},t.prototype.initialize=function(){this.XValue=this.config.longitude,this.YValue=this.config.latitude,this.ZValue=this.config.height},t.prototype.location=function(){var e=null;this.markerXY&&this.view.czm.viewer.entities.remove(this.markerXY),e=Cesium.Cartesian3.fromDegrees(this.XValue,this.YValue,this.ZValue),this.markerXY=new Cesium.Entity({id:"视角定位坐标",position:e,point:{pixelSize:6,color:Cesium.Color.WHITE.withAlpha(.9),outlineColor:Cesium.Color.WHITE.withAlpha(.9),outlineWidth:1},billboard:{image:this.folderUrl+"images/location4.png",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,scale:.6}}),this.view.czm.viewer.entities.add(this.markerXY),this.view.czm.camera.setView({destination:e})},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t}($),e.PlanetLocationComponent.ɵfac=function(t){return new(t||e.PlanetLocationComponent)},e.PlanetLocationComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetLocationComponent,selectors:[["epsgis-planet-location"]],features:[o.ɵɵInheritDefinitionFeature],decls:12,vars:13,consts:[[3,"ngModel","nzMin","nzMax","nzStep","nzPlaceHolder","ngModelChange"],[4,"ngIf"],["nz-button","","nzType","primary",3,"click"],[3,"ngModel","nzStep","nzPlaceHolder","ngModelChange"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"span"),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"nz-input-number",0),o.ɵɵlistener("ngModelChange",(function(e){return t.XValue=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"div"),o.ɵɵelementStart(5,"span"),o.ɵɵtext(6),o.ɵɵelementEnd(),o.ɵɵelementStart(7,"nz-input-number",0),o.ɵɵlistener("ngModelChange",(function(e){return t.YValue=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵtemplate(8,ae,4,4,"div",1),o.ɵɵelementStart(9,"div"),o.ɵɵelementStart(10,"button",2),o.ɵɵlistener("click",(function(){return t.location()})),o.ɵɵtext(11,"定位"),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(2),o.ɵɵtextInterpolate(t.item.X.label),o.ɵɵadvance(1),o.ɵɵproperty("ngModel",t.XValue)("nzMin",t.item.X.min)("nzMax",t.item.X.max)("nzStep",1e-4)("nzPlaceHolder",t.item.X.placeHolder),o.ɵɵadvance(3),o.ɵɵtextInterpolate(t.item.Y.label),o.ɵɵadvance(1),o.ɵɵproperty("ngModel",t.YValue)("nzMin",t.item.Y.min)("nzMax",t.item.Y.max)("nzStep",1e-4)("nzPlaceHolder",t.item.Y.placeHolder),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.item.Z))},directives:[s.NzInputNumberComponent,i.NgControlStatus,i.NgModel,t.NgIf,g.NzButtonComponent,I.NzWaveDirective,S.ɵNzTransitionPatchDirective],styles:["div[_ngcontent-%COMP%]{margin-bottom:5px;text-align:center}nz-input-number[_ngcontent-%COMP%]{width:80%}"]}),e.PlanetLocationComponent=j([r.ComponentRegister({uri:"epsgis-planet-location",path:"epsplanet/components/location",name:"PlanetLocationComponent"})],e.PlanetLocationComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetLocationComponent,[{type:o.Component,args:[{selector:"epsgis-planet-location",templateUrl:"./location.component.html",styleUrls:["./location.component.scss"]}]}],(function(){return[]}),null),e.PlanetModeSwitchComponent=function(e){function t(){var t=e.call(this)||this;return t.viewType="3d",t}return L(t,e),t.getCompInfo=function(){return{name:"PlanetModeSwitchComponent",path:"epsplanet/components/mode-switch"}},t.prototype.clickMe=function(){this.visible=!1},t.prototype.change=function(e){console.log(e)},t.prototype.changeViewMode=function(e){var t=this;"2d"==e?Promise.resolve().then((function(){t.view.czm.viewer.scene.morphTo2D(1)})):"columbus"==e?Promise.resolve().then((function(){t.view.czm.viewer.scene.morphToColumbusView(1)})):Promise.resolve().then((function(){t.view.czm.viewer.scene.morphTo3D(1)})),this.viewType=e},t}($),e.PlanetModeSwitchComponent.ɵfac=function(t){return new(t||e.PlanetModeSwitchComponent)},e.PlanetModeSwitchComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetModeSwitchComponent,selectors:[["epsgis-planet-mode-switch"]],features:[o.ɵɵInheritDefinitionFeature],decls:7,vars:6,consts:[["title","模式切换",1,"jimu-widget-onscreen-icon"],["nz-popover","","nzPopoverTrigger","click",1,"icon",3,"nzPopoverVisible","nzPopoverContent","nzPopoverPlacement","nzPopoverVisibleChange"],[4,"ngIf"],["contentTemplate",""],["width","32","height","32","viewBox","0 0 64 64",1,""],["d","m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z"],["d","m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z"],["d","m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z"],[1,"container"],[1,"mode",3,"click"],["width","40","height","40","viewBox","0 0 64 64",1,""]],template:function(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"div",1),o.ɵɵlistener("nzPopoverVisibleChange",(function(e){return t.visible=e})),o.ɵɵtemplate(2,le,3,0,"ng-container",2),o.ɵɵtemplate(3,se,3,0,"ng-container",2),o.ɵɵtemplate(4,ce,3,0,"ng-container",2),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵtemplate(5,pe,10,0,"ng-template",null,3,o.ɵɵtemplateRefExtractor)),2&e){var n=o.ɵɵreference(6);o.ɵɵadvance(1),o.ɵɵproperty("nzPopoverVisible",t.visible)("nzPopoverContent",n)("nzPopoverPlacement","right"),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","3d"==t.viewType),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","2d"==t.viewType),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","columbus"==t.viewType)}},directives:[u.NzPopoverDirective,t.NgIf],styles:[".icon[_ngcontent-%COMP%]{height:32px}.container[_ngcontent-%COMP%]{width:auto;height:50px;margin:-10px}.container[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{float:left;cursor:pointer;height:40px;line-height:40px;margin:5px;fill:#4e555d}.container[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{background-color:#4e555d;fill:#fff}"]}),e.PlanetModeSwitchComponent=j([r.ComponentRegister({uri:"epsgis-planet-mode-switch",path:"epsplanet/components/mode-switch",name:"PlanetModeSwitchComponent"})],e.PlanetModeSwitchComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetModeSwitchComponent,[{type:o.Component,args:[{selector:"epsgis-planet-mode-switch",templateUrl:"./mode-switch.component.html",styleUrls:["./mode-switch.component.scss"]}]}],(function(){return[]}),null),e.PlanetStatusBarComponent=function(e){function t(t){var n=e.call(this)||this;return n.cdr=t,n.fpsString="",n.cameraString="",n.baseVelocity=0,n.velocity=0,n.velocityRatio=1,n.lang={longitude:"经度",latitude:"纬度",height:"高度",fps:"帧率",heading:"偏航角",pitch:"俯仰角",roll:"翻滚角",meter:"米",velocity:"键盘运动速度",createPolylineTip:"左键添加点，右键删除点，shift+右键创建完成",editPolylineTip:"鼠标移动到其中一个点会出现一个操作栏，点击移动按钮，可以移动折线位置；点击增加按钮，可以在该位置增加一个点；点击删除按钮，可以删除该点",createRectangleTip:"点击左键确定矩形中心点，移动鼠标确定矩形方向和对角线长度，再次点击左键创建完成",editRectangleTip:"左键点击其中一个点移动矩形位置",createCircleTip:"点击左键确定圆的圆心，移动鼠标确定圆的半径，再次点击左键创建完成",editCircleTip:"左键点击其中一个点移动圆位置",createDoubleArrowTip:"在四个不同位置点击左键创建双箭头",editDoubleArrowTip:"左键点击其中一个点移动双箭头位置",createFlattenedPolygonTip:"左键添加点，右键删除点，shift+右键停止绘制，上下移动鼠标确定高度，再次点击左键创建完成",editFlattenedPolygonTip:"鼠标移动到其中一个点会出现一个操作栏，点击移动按钮，可以移动折线位置；点击增加按钮，可以在该位置增加一个点；点击删除按钮，可以删除该点",movableObjectTip:"鼠标左键点击坐标轴x,y,z任意一个轴，轴变黄色，可沿着相应位置进行移动，再次点击，轴恢复原色，停止移动，点击右键坐标轴消失",rotatableObjectTip:"鼠标左键点击旋转坐标轴任意一个轴，轴变黄色，可沿着相应位置进行旋转，再次点击，轴恢复原色，停止旋转，点击右键旋转坐标轴消失",positionPickingTip:"点击鼠标左键拾取位置"},n._disposers=[],n}return L(t,e),t.getCompInfo=function(){return{name:"PlanetStatusBarComponent",path:"epsplanet/components/status-bar"}},t.prototype.ngOnInit=function(){var e=this;this._scene=this.view.czm.scene,this._camera=this.view.czm.camera;var t=Cesium.Math.toDegrees,n=function(){var n=e._camera,o=t(n.positionCartographic.longitude).toFixed(5),i=t(n.positionCartographic.latitude).toFixed(5),a=n.positionCartographic.height.toFixed(2),l=t(n.heading).toFixed(2),s=t(n.pitch).toFixed(2),c=t(n.roll).toFixed(2);e.cameraString=e.lang.longitude+": "+o+"° "+e.lang.latitude+": "+i+"° "+e.lang.height+": "+a+e.lang.meter+" "+e.lang.heading+": "+l+"° "+e.lang.pitch+": "+s+"° "+e.lang.roll+": "+c+"°",r.UtilsService.detectChanges(e.cdr)};this._disposers=[],this._disposers.push(this._camera.changed.addEventListener(n)),n(),this._scene.debugShowFramesPerSecond=!0;var o=this._scene._postRender.addEventListener((function(){o(),e._scene._performanceContainer.style.visibility="hidden"}));this._disposers.push(this._scene._postRender.addEventListener((function(){e._scene._performanceDisplay?e.fpsString=e.lang.fps+": "+e._scene._performanceDisplay._fpsText.nodeValue+" ":e.fpsString=""}))),this._disposers.push(XE.MVVM.track(this,"baseVelocity",this.view.camera.immersion,"baseVelocity")),this._disposers.push(XE.MVVM.track(this,"velocity",this.view.camera.immersion,"velocity")),this._disposers.push(XE.MVVM.bind(this,"velocityRatio",this.view.camera.immersion,"velocityRatio")),this._uw1?this._uw1=this._uw1():this._uw1=XE.MVVM.watch((function(){return e.view.interaction.creatingPolylineBinding.target}),(function(){void 0!==e.view.interaction.creatingPolylineBinding.target&&("GeoRectangle"===e.view.interaction.creatingPolylineBinding.target.xbsjType||"GeoCircle"===e.view.interaction.creatingPolylineBinding.target.xbsjType||e.view.interaction.creatingPolylineBinding.target.xbsjType)})),this._uw2?this._uw2=this._uw2():this._uw2=XE.MVVM.watch((function(){return e.view.interaction.editingPolylineBinding.target}),(function(){void 0!==e.view.interaction.editingPolylineBinding.target&&("GeoRectangle"===e.view.interaction.editingPolylineBinding.target.xbsjType||"GeoCircle"===e.view.interaction.editingPolylineBinding.target.xbsjType||e.view.interaction.editingPolylineBinding.target.xbsjType)})),this._uw3?this._uw3=this._uw3():this._uw3=XE.MVVM.watch((function(){return e.view.interaction.creatingPolygonBinding.target}),(function(){e.view.interaction.creatingPolygonBinding.target})),this._uw4?this._uw4=this._uw4():this._uw4=XE.MVVM.watch((function(){return e.view.interaction.flattenedPolygonCreatingBinding.target}),(function(){e.view.interaction.flattenedPolygonCreatingBinding.target})),this._uw5?this._uw5=this._uw5():this._uw5=XE.MVVM.watch((function(){return e.view.interaction.editingPolygonBinding.target}),(function(){e.view.interaction.editingPolygonBinding.target})),this._uw6?this._uw6=this._uw4():this._uw6=XE.MVVM.watch((function(){return e.view.interaction.movableObjectBinding.target}),(function(){e.view.interaction.movableObjectBinding.target})),this._uw7?this._uw7=this._uw4():this._uw7=XE.MVVM.watch((function(){return e.view.interaction.rotatableObjectBinding.target}),(function(){e.view.interaction.rotatableObjectBinding.target})),this._uw8?this._uw8=this._uw4():this._uw8=XE.MVVM.watch((function(){return e.view.interaction.positionPickingBinding.target}),(function(){e.view.interaction.positionPickingBinding.target}))},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this),this._disposers.forEach((function(e){return e()})),this._disposers.length=0,this._uw1=this._uw1&&this._uw1(),this._uw2=this._uw2&&this._uw2(),this._uw3=this._uw3&&this._uw3(),this._uw4=this._uw4&&this._uw4(),this._uw5=this._uw5&&this._uw5(),this._uw6=this._uw6&&this._uw6(),this._uw7=this._uw7&&this._uw7(),this._uw8=this._uw8&&this._uw8()},t.prototype.velocityString=function(){return" "+this.lang.velocity+": "+this.velocity.toFixed(1)+" km/h ("+this.baseVelocity.toFixed(1)+" × "+this.velocityRatio.toFixed(1)+")"},t}($),e.PlanetStatusBarComponent.ɵfac=function(t){return new(t||e.PlanetStatusBarComponent)(o.ɵɵdirectiveInject(o.ChangeDetectorRef))},e.PlanetStatusBarComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetStatusBarComponent,selectors:[["epsgis-planet-status-bar"]],features:[o.ɵɵInheritDefinitionFeature],decls:2,vars:3,consts:[[1,"status-info"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(1),o.ɵɵtextInterpolate3("",t.fpsString," ",t.cameraString," ",t.velocityString(),""))},styles:[".status-info[_ngcontent-%COMP%]{background-color: #4c555e; color:#fff; font-size: 14px;}"]}),e.PlanetStatusBarComponent=j([r.ComponentRegister({uri:"epsgis-planet-status-bar",path:"epsplanet/components/status-bar",name:"PlanetStatusBarComponent"})],e.PlanetStatusBarComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetStatusBarComponent,[{type:o.Component,args:[{selector:"epsgis-planet-status-bar",template:'<div class="status-info">{{ fpsString }} {{cameraString}} {{ velocityString() }}</div>',styles:[".status-info{background-color: #4c555e; color:#fff; font-size: 14px;}"]}]}],(function(){return[{type:o.ChangeDetectorRef}]}),null),e.PlanetZoomComponent=function(e){function t(){return e.call(this)||this}return L(t,e),t.getCompInfo=function(){return{name:"PlanetZoomComponent",path:"epsplanet/components/zoom"}},t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){document.getElementsByClassName("jimu-widget-onscreen-icon zoomOut")[0].style.top=document.getElementsByClassName("jimu-widget-onscreen-icon zoomIn")[0].offsetHeight+"px"},t.prototype.zoomIn=function(){var e=this.view.czm.viewer;this.getCesiumView().camera.zoomIn(e.camera.positionCartographic.height/Math.abs(Math.sin(e.camera.pitch))*.2)},t.prototype.zoomOut=function(){var e=this.view.czm.viewer;e.camera.zoomOut(e.camera.positionCartographic.height/Math.abs(Math.sin(e.camera.pitch))*.2)},t}($),e.PlanetZoomComponent.ɵfac=function(t){return new(t||e.PlanetZoomComponent)},e.PlanetZoomComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetZoomComponent,selectors:[["epsgis-planet-zoom"]],features:[o.ɵɵInheritDefinitionFeature],decls:4,vars:0,consts:[["title","放大",1,"jimu-widget-onscreen-icon","zoomIn",3,"click"],["nz-icon","","nzType","plus","nzTheme","outline"],["title","缩小",1,"jimu-widget-onscreen-icon","zoomOut",3,"click"],["nz-icon","","nzType","minus","nzTheme","outline"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵlistener("click",(function(){return t.zoomIn()})),o.ɵɵelement(1,"i",1),o.ɵɵelementEnd(),o.ɵɵelementStart(2,"div",2),o.ɵɵlistener("click",(function(){return t.zoomOut()})),o.ɵɵelement(3,"i",3),o.ɵɵelementEnd())},directives:[a.NzIconDirective,S.ɵNzTransitionPatchDirective],styles:[".jimu-widget-onscreen-icon[_ngcontent-%COMP%]{margin-top:20px}"]}),e.PlanetZoomComponent=j([r.ComponentRegister({uri:"epsgis-planet-zoom",path:"epsplanet/components/zoom",name:"PlanetZoomComponent"})],e.PlanetZoomComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetZoomComponent,[{type:o.Component,args:[{selector:"epsgis-planet-zoom",templateUrl:"./zoom.component.html",styleUrls:["./zoom.component.scss"]}]}],(function(){return[]}),null),e.PlanetBasemapGalleryComponent=function(e){function t(t){var n=e.call(this)||this;return n.nzContextMenuService=t,n.layerNodes=[],n.terrainData=[{czmObject:{img:"https://lab2.cesiumlab.com/upload/3fd1ac60-2683-4ae8-a5da-c0250edc836b/2019_08_02_19_45_38.jpg",xbsjType:"Terrain",xbsjGuid:"0b34ebd4-5a5b-4f1d-b2e8-a41797193aa8",name:"中国14级（测试）",xbsjTerrainProvider:{type:"XbsjCesiumTerrainProvider",XbsjEllipsoidTerrainProvider:{},XbsjCesiumTerrainProvider:{url:"https://lab.earthsdk.com/terrain/577fd5b0ac1f11e99dbd8fd044883638",requestVertexNormals:!0,requestWaterMask:!0},GoogleEarthEnterpriseTerrainProvider:{}}}}],n.terrainIcon="https://lab2.cesiumlab.com/upload/3fd1ac60-2683-4ae8-a5da-c0250edc836b/2019_08_02_19_45_38.jpg",n}return L(t,e),t.prototype.activeNode=function(e){this.activatedNode=e.node},t.prototype.contextMenu=function(e,t){this.nzContextMenuService.create(e,t)},t.prototype.onCheckedChange=function(e){"check"===e.eventName&&e.node&&(e.node.isChecked?G.GetXbsjCzmObject(e.node).show=!0:G.GetXbsjCzmObject(e.node).show=!1)},t.prototype.onRightClick=function(e){},t.prototype.ngOnInit=function(){var t=this;e.prototype.ngOnInit.call(this);XE.MVVM.watch((function(){return k(t.view.sceneTree.$refs.basemap.children)}),(function(){t.loadBaseTree()}))},t.prototype.loadBaseTree=function(){var e=this;setTimeout((function(){var t=G.SceneTree2NgZorroTree(e.view.sceneTree.$refs.basemap);e.layerNodes=k(t[0]._children),e.view.sceneTree.$refs.basemap.children[0].czmObject.xbsjZIndex=-1}),100)},t.prototype.selectImage=function(e){console.log(G.loadLayerNode(e));var t=G.loadLayerNode(e);t.czmObject.show=!0,this.view.sceneTree.$refs.basemap.children[0]=t},t.prototype.selectTerrain=function(e){this.view.sceneTree.$refs.basemap.children.push(e)},t.prototype.ngAfterViewInit=function(){e.prototype.ngAfterViewInit.call(this)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t}($),e.PlanetBasemapGalleryComponent.ɵfac=function(t){return new(t||e.PlanetBasemapGalleryComponent)(o.ɵɵdirectiveInject(f.NzContextMenuService))},e.PlanetBasemapGalleryComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetBasemapGalleryComponent,selectors:[["epsgis-planet-basemap-gallery"]],features:[o.ɵɵInheritDefinitionFeature],decls:12,vars:4,consts:[["nzTitle","影像"],[3,"click",4,"ngFor","ngForOf"],["nzTitle","地形"],["nzBlockNode","","nzCheckable","",3,"nzData","nzTreeTemplate","nzClick","nzCheckBoxChange"],["nzTreeTemplate",""],[3,"click"],[1,"backimg"],[3,"src"],[2,"width","100%","white-space","nowrap","text-overflow","ellipsis","overflow","hidden","text-align","left",3,"title"],[1,"custom-node"],[4,"ngIf"],[1,"folder-name"]],template:function(e,t){if(1&e&&(o.ɵɵelementStart(0,"nz-tabset"),o.ɵɵelementStart(1,"nz-tab",0),o.ɵɵelementStart(2,"ul"),o.ɵɵtemplate(3,ue,6,3,"li",1),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"nz-tabset"),o.ɵɵelementStart(5,"nz-tab",2),o.ɵɵelementStart(6,"ul"),o.ɵɵtemplate(7,me,6,3,"li",1),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelement(8,"nz-divider"),o.ɵɵelementStart(9,"nz-tree",3),o.ɵɵlistener("nzClick",(function(e){return t.activeNode(e)}))("nzCheckBoxChange",(function(e){return t.onCheckedChange(e)})),o.ɵɵelementEnd(),o.ɵɵtemplate(10,he,3,2,"ng-template",null,4,o.ɵɵtemplateRefExtractor)),2&e){var n=o.ɵɵreference(11);o.ɵɵadvance(3),o.ɵɵproperty("ngForOf",t.config.basemaps),o.ɵɵadvance(4),o.ɵɵproperty("ngForOf",t.config.terrain),o.ɵɵadvance(2),o.ɵɵproperty("nzData",t.layerNodes)("nzTreeTemplate",n)}},directives:[C.NzTabSetComponent,C.NzTabComponent,t.NgForOf,m.NzDividerComponent,c.NzTreeComponent,t.NgIf],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}img[_ngcontent-%COMP%]{width:70px;height:70px}li[_ngcontent-%COMP%]{float:left;list-style:none;height:100px;cursor:pointer}.backimg[_ngcontent-%COMP%]{width:70px;height:70px;border:1px solid;border-radius:3px;background:grey;margin:3px}.backimg[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;width:70px;text-align:center}.ipt[_ngcontent-%COMP%], .ipt1[_ngcontent-%COMP%], .ipt2[_ngcontent-%COMP%]{margin-bottom:5px}.ant-input[_ngcontent-%COMP%]{width:70%}nz-select[_ngcontent-%COMP%]{width:50%}.footer[_ngcontent-%COMP%]{margin-top:5px;float:right}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:50px}.schema[_ngcontent-%COMP%]{position:absolute;top:5px;left:5px}  .ant-tabs-tab{padding:0}"]}),e.PlanetBasemapGalleryComponent=j([r.ComponentRegister({uri:"epsgis-planet-basemap-gallery",path:"epsplanet/components/basemap-gallery",name:"PlanetBasemapGalleryComponent"})],e.PlanetBasemapGalleryComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetBasemapGalleryComponent,[{type:o.Component,args:[{selector:"epsgis-planet-basemap-gallery",templateUrl:"./basemap-gallery.component.html",styleUrls:["./basemap-gallery.component.scss"]}]}],(function(){return[{type:f.NzContextMenuService}]}),null);var fe=[],ve=[],ye=[],Ce=null,ze=function(){function e(e){this.http=e,this.earth=window.earth,this.earth.interaction.picking.enabled=!1,this.earth.interaction.picking.hoverEnable=!1,this.earth.epsplanet={},this.earth.epsplanet.allowClick=!1}return e.prototype.httpReq=function(e,t){return"post"==e?this.http.httpClient.post(t,"").toPromise():"get"==e?this.http.httpClient.get(t).toPromise():void 0},e.prototype.GetFeatureInfo=function(e,t,n,o){var i=this;null==Ce&&(Ce=new Cesium.CustomDataSource("highLight"),t.czm.viewer.dataSources.add(Ce));var r=t.czm.scene,a=t.czm.viewer,l=this.GetWFSUrl(e.xbsjImageryProvider),s=new Cesium.ScreenSpaceEventHandler(r.canvas),c="";s.setInputAction((function(r){if(t.epsplanet.allowClick&&e.show){var s=t.czm.viewer.scene.pick(r.position);if(!Cesium.defined(s)){t.sceneTree.$refs.pin1.czmObject.customProp=!1,Ce.entities.removeAll(),ye=[],t.sceneTree.$refs.pin1.czmObject.position=i.Cartesian2ToCartographic(a,r.position);var p=i.Cartesian2ToWGS84(a,r.position),u=i.Buffer([p.lon,p.lat],100);"point"==n?c='<Filter xmlns="http://www.opengis.net/ogc" xmlns:gml="http://www.opengis.net/gml"><Intersects><PropertyName>the_geom</PropertyName><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>'+u+"</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></Intersects></Filter>":(n="line")||(n="polygon"),i.httpReq("post",l+c).then((function(t){if(t.features.length>0){var n=t.features[0].properties,i=[];Object.keys(n).map((function(e){return i.push({name:e,value:n[e]})})),fe.push(i),ve.push(e),ye.push(t),setTimeout((function(){if(ye.length>1)if(ve[0]._ci>ve[1]._ci){if(ve[0]._ci!==e._ci)return;"function"==typeof o&&(o(fe[0]),Cesium.GeoJsonDataSource.load(ye[0]).then((function(e){e.entities.values.forEach((function(e){Ce.entities.add(e)}))})))}else{if(ve[1]._ci!==e._ci)return;"function"==typeof o&&(o(fe[1]),Cesium.GeoJsonDataSource.load(ye[1]).then((function(e){e.entities.values.forEach((function(e){Ce.entities.add(e)}))})))}else"function"==typeof o&&(o(i),Cesium.GeoJsonDataSource.load(t).then((function(e){e.entities.values.forEach((function(e){Ce.entities.add(e)}))})))}),100),setTimeout((function(){ye=[],fe=[],ve=[]}),1e3)}})).catch((function(e){}))}}}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},e.prototype.InitHandler=function(){},e.prototype.getLayers=function(e,t,n){var o=this;null==Ce&&(Ce=new Cesium.CustomDataSource("highLight"),t.czm.viewer.dataSources.add(Ce));var i=new Cesium.ScreenSpaceEventHandler(t.czm.scene.canvas),r=e.xbsjImageryProvider.WebMapTileServiceImageryProvider.url||e.xbsjImageryProvider.WebMapServiceImageryProvider.url,a="";"WebMapTileServiceImageryProvider"==e.xbsjImageryProvider.type?a=r.split("MapServer")[0]+"MapServer/layers?f=pjson":"WebMapServiceImageryProvider"==e.xbsjImageryProvider.type&&(a=r.split("arcgis")[0]+"arcgis/rest"+r.split("arcgis")[1].split("MapServer")[0]+"MapServer/layers?f=pjson"),this.httpReq("get",a).then((function(a){i.setInputAction((function(i){if(null!=a.layers&&t.epsplanet.allowClick&&e.show){var l=t.czm.viewer.scene.pick(i.position);if(!Cesium.defined(l)){Ce&&Ce.entities.removeAll(),t.sceneTree.$refs.pin1.czmObject.customProp=!1,t.sceneTree.$refs.pin1.czmObject.position=o.Cartesian2ToCartographic(t.czm.viewer,i.position);var s=o.Cartesian2ToWGS84(t.czm.viewer,i.position),c=o.Buffer([s.lon,s.lat],1),p=o.GetWFSUrl(e.xbsjImageryProvider),u=r.split("/MapServer")[0].split("services/")[1],m=[],d=[];if("WebMapTileServiceImageryProvider"==e.xbsjImageryProvider.type)for(var g=function(e){var t=a.layers[e],n=p+"typename="+u+":"+t.name+'&Filter=<ogc:Filter><ogc:Intersects><ogc:PropertyName>Shape</ogc:PropertyName><gml:Polygon srsName="urn:x-ogc:def:crs:EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>'+c+"</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon></ogc:Intersects></ogc:Filter>";o.httpReq("get",n).then().catch((function(e){var n=e.error.text;if(o.xml2Json(o.stringToXml(n)).FeatureCollection.featureMember){var i=o.xml2Json(o.stringToXml(n)).FeatureCollection.featureMember[t.name],r=[],a={};if(null==i||null==i)return;Object.keys(i).map((function(e){if("Shape"!==e)r.push({name:e,value:i[e].value});else if(i[e].MultiSurface){(o=i[e].MultiSurface.surfaceMember.Polygon.exterior.LinearRing.posList.value.split(" ")).shift();for(var t=[],n=0;n<o.length;n+=2)t.push([o[n],o[n+1]]);a={type:"Feature",geometry:{type:"LineString",coordinates:t}}}else if(i[e].Point){var o=i[e].Point.pos.value.split(" ");a={type:"Feature",geometry:{type:"Point",coordinates:o}}}else if(i[e].MultiCurve){o=i[e].MultiCurve.curveMember.LineString.posList.value.split(" "),t=[];for(var l=0;l<o.length;l+=2)t.push([o[l],o[l+1]]);a={type:"Feature",geometry:{type:"LineString",coordinates:t}}}})),m.push(r),d.push(a)}}))},h=0;h<a.layers.length;h++)g(h);else if("WebMapServiceImageryProvider"==e.xbsjImageryProvider.type){var f=e.xbsjImageryProvider.WebMapServiceImageryProvider.layers.split(","),v=function(e){var t=a.layers[a.layers.length-1-f[e]],n=p+"typename="+u+":"+t.name+'&Filter=<ogc:Filter><ogc:Intersects><ogc:PropertyName>Shape</ogc:PropertyName><gml:Polygon srsName="urn:x-ogc:def:crs:EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>'+c+"</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon></ogc:Intersects></ogc:Filter>";o.httpReq("get",n).then().catch((function(e){var n=e.error.text;if(null!=o.xml2Json(o.stringToXml(n)).FeatureCollection&&o.xml2Json(o.stringToXml(n)).FeatureCollection.featureMember){var i=o.xml2Json(o.stringToXml(n)).FeatureCollection.featureMember[t.name],r=[],a={};if(null==i||null==i)return;Object.keys(i).map((function(e){if("Shape"!==e)r.push({name:e,value:i[e].value});else if(i[e].MultiSurface){(o=i[e].MultiSurface.surfaceMember.Polygon.exterior.LinearRing.posList.value.split(" ")).shift();for(var t=[],n=0;n<o.length;n+=2)t.push([o[n],o[n+1]]);a={type:"Feature",geometry:{type:"LineString",coordinates:t}}}else if(i[e].Point){var o=i[e].Point.pos.value.split(" ");a={type:"Feature",geometry:{type:"Point",coordinates:o}}}else if(i[e].MultiCurve){o=i[e].MultiCurve.curveMember.LineString.posList.value.split(" "),t=[];for(var l=0;l<o.length;l+=2)t.push([o[l],o[l+1]]);a={type:"Feature",geometry:{type:"LineString",coordinates:t}}}})),m.push(r),d.push(a)}}))};for(h=0;h<f.length;h++)v(h)}setTimeout((function(){m.length>0&&d.length>0&&("Point"==d[0].geometry.type?Cesium.GeoJsonDataSource.load(d[0]).then((function(e){e.entities.values.forEach((function(e){e.billboard=null,e.point=new Cesium.PointGraphics({show:!0,color:Cesium.Color.AQUA,pixelSize:10,clampToGround:!0}),Ce.entities.add(e)}))})):"LineString"==d[0].geometry.type?Cesium.GeoJsonDataSource.load(d[0]).then((function(e){e.entities.values.forEach((function(e){e.polyline.width=10,e.polyline.clampToGround=!0,e.polyline.material=new Cesium.PolylineGlowMaterialProperty({glowPower:.2,color:Cesium.Color.BLUE}),Ce.entities.add(e)}))})):Cesium.GeoJsonDataSource.load(d[0]).then((function(e){e.entities.values.forEach((function(e){Ce.entities.add(e)}))})),n(m[0]))}),500)}}}),Cesium.ScreenSpaceEventType.LEFT_CLICK)}))},e.prototype.test=function(e,t,n){var o=this;e.sort((function(e,t){return t._ci-e._ci})),null==Ce&&(Ce=new Cesium.CustomDataSource("highLight"),t.czm.viewer.dataSources.add(Ce)),new Cesium.ScreenSpaceEventHandler(t.czm.scene.canvas).setInputAction((function(i){e.forEach((function(e,r){if(t.epsplanet.allowClick&&e.show){var a=t.czm.viewer.scene.pick(i.position);if(!Cesium.defined(a)){Ce&&Ce.entities.removeAll(),t.sceneTree.$refs.pin1.czmObject.customProp=!1,t.sceneTree.$refs.pin1.czmObject.position=o.Cartesian2ToCartographic(t.czm.viewer,i.position);var l=e.xbsjImageryProvider.WebMapTileServiceImageryProvider.url||e.xbsjImageryProvider.WebMapServiceImageryProvider.url,s="";"WebMapTileServiceImageryProvider"==e.xbsjImageryProvider.type?s=l.split("MapServer")[0]+"MapServer/layers?f=pjson":"WebMapServiceImageryProvider"==e.xbsjImageryProvider.type&&(s=l.split("arcgis")[0]+"arcgis/rest"+l.split("arcgis")[1].split("MapServer")[0]+"MapServer/layers?f=pjson");var c=o.Cartesian2ToWGS84(t.czm.viewer,i.position),p=o.Buffer([c.lon,c.lat],1),u=o.GetWFSUrl(e.xbsjImageryProvider),m=l.split("/MapServer")[0].split("services/")[1];o.httpFuncA(e,m,p,u,s,(function(e,t){Ce.entities.values&&Ce.entities.values.length>0||e.length>0&&t.length>0&&("Point"==t[0].geometry.type?Cesium.GeoJsonDataSource.load(t[0]).then((function(e){e.entities.values.forEach((function(e){e.billboard=null,e.point=new Cesium.PointGraphics({show:!0,color:Cesium.Color.AQUA,pixelSize:10,clampToGround:!0}),Ce.entities.add(e)}))})):"LineString"==t[0].geometry.type?Cesium.GeoJsonDataSource.load(t[0]).then((function(e){e.entities.values.forEach((function(e){e.polyline.width=10,e.polyline.clampToGround=!0,e.polyline.material=new Cesium.PolylineGlowMaterialProperty({glowPower:.2,color:Cesium.Color.BLUE}),Ce.entities.add(e)}))})):Cesium.GeoJsonDataSource.load(t[0]).then((function(e){e.entities.values.forEach((function(e){Ce.entities.add(e)}))})),n(e[0]))}))}}}))}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},e.prototype.httpFuncA=function(e,t,n,o,i,r){var a=this,l=[],s=[];this.httpFuncB(i,(function(i){if(null!=i.layers)if("WebMapTileServiceImageryProvider"==e.xbsjImageryProvider.type)for(var c=function(e){var c=i.layers[e],p=o+"typename="+t+":"+c.name+'&Filter=<ogc:Filter><ogc:Intersects><ogc:PropertyName>Shape</ogc:PropertyName><gml:Polygon srsName="urn:x-ogc:def:crs:EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>'+n+"</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon></ogc:Intersects></ogc:Filter>";a.httpFunc(p,(function(e){var t=e.error.text,n=a.xml2Json(a.stringToXml(t)).FeatureCollection;if(null!=n&&n.featureMember)if(n.featureMember.length){var o=n.featureMember[0][c.name],i=[],p={};if(null==o||null==o)return;Object.keys(o).map((function(e){if("Shape"!==e)i.push({name:e,value:o[e].value});else if(o[e].MultiSurface){(r=o[e].MultiSurface.surfaceMember.Polygon.exterior.LinearRing.posList.value.split(" ")).shift();for(var t=[],n=0;n<r.length;n+=2)t.push([r[n],r[n+1]]);p={type:"Feature",geometry:{type:"LineString",coordinates:t}}}else if(o[e].Point){var r=o[e].Point.pos.value.split(" ");p={type:"Feature",geometry:{type:"Point",coordinates:r}}}else if(o[e].MultiCurve){r=o[e].MultiCurve.curveMember.LineString.posList.value.split(" "),t=[];for(var a=0;a<r.length;a+=2)t.push([r[a],r[a+1]]);p={type:"Feature",geometry:{type:"LineString",coordinates:t}}}})),l.push(i),s.push(p),r(l,s)}else{var u=n.featureMember[c.name],m=[],d={};if(null==u||null==u)return;Object.keys(u).map((function(e){if("Shape"!==e)m.push({name:e,value:u[e].value});else if(u[e].MultiSurface){(o=u[e].MultiSurface.surfaceMember.Polygon.exterior.LinearRing.posList.value.split(" ")).shift();for(var t=[],n=0;n<o.length;n+=2)t.push([o[n],o[n+1]]);d={type:"Feature",geometry:{type:"LineString",coordinates:t}}}else if(u[e].Point){var o=u[e].Point.pos.value.split(" ");d={type:"Feature",geometry:{type:"Point",coordinates:o}}}else if(u[e].MultiCurve){o=u[e].MultiCurve.curveMember.LineString.posList.value.split(" "),t=[];for(var i=0;i<o.length;i+=2)t.push([o[i],o[i+1]]);d={type:"Feature",geometry:{type:"LineString",coordinates:t}}}})),l.push(m),s.push(d),r(l,s)}}))},p=0;p<i.layers.length;p++)c(p);else if("WebMapServiceImageryProvider"==e.xbsjImageryProvider.type){var u=e.xbsjImageryProvider.WebMapServiceImageryProvider.layers.split(","),m=function(e){var c=i.layers[i.layers.length-1-u[e]],p=o+"typename="+t+":"+c.name+'&Filter=<ogc:Filter><ogc:Intersects><ogc:PropertyName>Shape</ogc:PropertyName><gml:Polygon srsName="urn:x-ogc:def:crs:EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>'+n+"</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon></ogc:Intersects></ogc:Filter>";a.httpFunc(p,(function(e){if(!(l.length>0)){var t=e.error.text,n=a.xml2Json(a.stringToXml(t)).FeatureCollection;if(null!=n&&n.featureMember)if(n.featureMember.length){var o=n.featureMember[0][c.name],i=[],p={};if(null==o||null==o)return;Object.keys(o).map((function(e){if("Shape"!==e)i.push({name:e,value:o[e].value});else if(o[e].MultiSurface){(r=o[e].MultiSurface.surfaceMember.Polygon.exterior.LinearRing.posList.value.split(" ")).shift();for(var t=[],n=0;n<r.length;n+=2)t.push([r[n],r[n+1]]);p={type:"Feature",geometry:{type:"LineString",coordinates:t}}}else if(o[e].Point){var r=o[e].Point.pos.value.split(" ");p={type:"Feature",geometry:{type:"Point",coordinates:r}}}else if(o[e].MultiCurve){r=o[e].MultiCurve.curveMember.LineString.posList.value.split(" "),t=[];for(var a=0;a<r.length;a+=2)t.push([r[a],r[a+1]]);p={type:"Feature",geometry:{type:"LineString",coordinates:t}}}})),l.push(i),s.push(p),r(l,s)}else{var u=n.featureMember[c.name],m=[],d={};if(null==u||null==u)return;Object.keys(u).map((function(e){if("Shape"!==e)m.push({name:e,value:u[e].value});else if(u[e].MultiSurface){(o=u[e].MultiSurface.surfaceMember.Polygon.exterior.LinearRing.posList.value.split(" ")).shift();for(var t=[],n=0;n<o.length;n+=2)t.push([o[n],o[n+1]]);d={type:"Feature",geometry:{type:"LineString",coordinates:t}}}else if(u[e].Point){var o=u[e].Point.pos.value.split(" ");d={type:"Feature",geometry:{type:"Point",coordinates:o}}}else if(u[e].MultiCurve){o=u[e].MultiCurve.curveMember.LineString.posList.value.split(" "),t=[];for(var i=0;i<o.length;i+=2)t.push([o[i],o[i+1]]);d={type:"Feature",geometry:{type:"LineString",coordinates:t}}}})),l.push(m),s.push(d),r(l,s)}}}))};for(p=u.length-1;p>=0;p--)m(p)}}))},e.prototype.httpFuncB=function(e,t){this.httpReq("get",e).then((function(e){t(e)}))},e.prototype.httpFuncC=function(){},e.prototype.httpFunc=function(e,t){this.httpReq("get",e).then().catch((function(e){t(e)}))},e.prototype.pickModel=function(e,t){var n=new Cesium.ScreenSpaceEventHandler(e.czm.scene.canvas);n.setInputAction((function(o){if(e.epsplanet.allowClick){var i=e.czm.viewer.scene.pickPosition(o.position),r=e.czm.viewer.scene.pick(o.position);if(Cesium.defined(r)&&r.getPropertyNames){var a=Cesium.Cartographic.fromCartesian(i);e.sceneTree.$refs.pin1.czmObject.position=[a.longitude,a.latitude,a.height];var l=r.getPropertyNames(),s=[];l.forEach((function(e){s.push({name:e,value:r.getProperty(e)})})),t(s,n)}else e.sceneTree.$refs.pin1.czmObject.customProp=!1}}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},e.prototype.Cartesian2ToWGS84=function(e,t){var n=e.camera.getPickRay(t),o=e.scene.globe.pick(n,e.scene),i=Cesium.Cartographic.fromCartesian(o);return{lon:Cesium.Math.toDegrees(i.longitude),lat:Cesium.Math.toDegrees(i.latitude)}},e.prototype.Cartesian2ToCartographic=function(e,t){var n=e.camera.getPickRay(t),o=e.scene.globe.pick(n,e.scene),i=Cesium.Cartographic.fromCartesian(o);return[i.longitude,i.latitude,i.height]},e.prototype.GetWFSUrl=function(e){var t="";if("WebMapTileServiceImageryProvider"==e.type){var n=e.WebMapTileServiceImageryProvider;-1!==n.url.indexOf("arcgis")?t=n.url.split("rest")[0]+n.url.split("rest/")[1].split("MapServer")[0]+"MapServer/WFSServer?request=GetFeature&service=WFS&version=1.1.0&":-1!==n.url.indexOf("geoserver")&&(t=n.url.split("gwc")[0]+n.layer.split(":")[0]+"/ows?service=WFS&version=1.0.0&request=GetFeature&typeName="+n.layer+"&maxFeatures=1&outputFormat=json&filter=")}if("WebMapServiceImageryProvider"==e.type){var o=e.WebMapServiceImageryProvider;-1!==o.url.indexOf("arcgis")?t=o.url.split("MapServer")[0]+"MapServer/WFSServer?request=GetFeature&service=WFS&version=1.1.0&":-1!==o.url.indexOf("geoserver")&&(t=o.url.split("wms")[0]+"/ows?service=WFS&version=1.0.0&request=GetFeature&typeName="+o.layers+"&maxFeatures=1&outputFormat=json&filter=")}return t},e.prototype.Buffer=function(e,t){var n=O.default.point(e),o=O.default.buffer(n,t,"meters").geometry.coordinates[0];return this.pointsToDegreesArray(o)},e.prototype.pointsToDegreesArray=function(e){var t="";return e.map((function(e){t+=e[0]+","+e[1]+" "})),t},e.prototype.ClearHighLight=function(){Ce.entities.removeAll()},e.prototype.xml2Json=function(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var o=e.attributes.item(n);-1==o.nodeName.indexOf(":")?t["@attributes"][o.nodeName]=o.nodeValue:t["@attributes"][o.nodeName.split(":")[1]]=o.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var r=e.childNodes.item(i),a=r.nodeName;if(void 0===t[a.split(":")[1]])null==a.split(":")[1]?t.value=this.xml2Json(r):t[a.split(":")[1]]=this.xml2Json(r);else{if(void 0===t[a.split(":")[1]].length){var l=t[a.split(":")[1]];t[a.split(":")[1]]=[],t[a.split(":")[1]].push(l)}t[a.split(":")[1]].push(this.xml2Json(r))}}return t},e.prototype.stringToXml=function(e){var t;"string"==typeof e?document.implementation.createDocument&&(t=(new DOMParser).parseFromString(e,"text/xml")):t=e;return t},e}();function we(e,t){if(1&e&&(o.ɵɵelementStart(0,"tr"),o.ɵɵelementStart(1,"td"),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"td"),o.ɵɵtext(4),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.name),o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.value)}}ze.ɵfac=function(e){return new(e||ze)(o.ɵɵinject(r.HttpReqService))},ze.ɵprov=o.ɵɵdefineInjectable({token:ze,factory:ze.ɵfac,providedIn:"root"}),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(ze,[{type:o.Injectable,args:[{providedIn:"root"}]}],(function(){return[{type:r.HttpReqService}]}),null);var Me=function(e,t){return{left:e,bottom:t}};e.PlanetIdentifyComponent=function(e){function t(t){var n=e.call(this)||this;return n.identify=t,n.winPos=[0,0,0,0],n.title="",n.pin1=null,n.propertyList=[{name:"1",value:2}],n.showInfo=!1,n.switchValue=!1,n.czmObjList=[],n}return L(t,e),t.prototype.createInfoWin=function(){var e=document.createElement("div");return e.className="dialog",e.style.left=this.winPos[0]-80+"px",e.style.bottom=this.winPos[3]-320+"px",e.innerHTML='<div class="panel">\n    <span>'+this.title+'</span><i nz-icon nzType="close" nzTheme="outline" (click)="close()" style="float: right;"></i>\n    <nz-table #basicTable [nzData]="propertyList" [nzFrontPagination]="false" [nzShowPagination]="false"\n        [nzTitle]="null">\n        <tbody>\n            <tr *ngFor="let data of basicTable.data">\n                <td>{{ data.name }}</td>\n                <td>{{ data.value }}</td>\n            </tr>\n        </tbody>\n    </nz-table>\n    <i nz-icon nzType="zoom-in" nzTheme="outline" (click)="zoomTo()"></i><span>缩放至</span>\n</div>\n<div class="arrow"></div>',document.getElementsByClassName("cesium-viewer")[0].append(e),e},t.prototype.Init=function(){var e=this,t=document.getElementsByClassName("dialog")[0];t.parentNode.removeChild(t),document.getElementsByClassName("cesium-viewer")[0].append(t),window.showInfo=this.showInfo,this.view.sceneTree.$refs.pin.children.push({ref:"pin1",czmObject:{name:"Pin1",xbsjType:"Pin",position:[1,1,0],near:30,show:!1,customProp:this.showInfo}}),this.pin1=this.view.sceneTree.$refs.pin1.czmObject,XE.MVVM.watch((function(){return e.pin1.winPos}),(function(){e.winPos=e.pin1.winPos,console.log("win",e.winPos)})),XE.MVVM.watch((function(){return e.pin1.customProp}),(function(){e.pin1.customProp||(e.showInfo=!1)})),null!=this.view&&(this.bindIndentify(this.view.sceneTree.$refs.layerlist),this.identify.test(this.czmObjList,this.view,(function(t){console.log("res:",t),e.pin1.customProp=!0,e.showInfo=!0,e.propertyList=t})),this.identify.pickModel(this.view,(function(t,n){e.pin1.customProp=!0,e.showInfo=!0,e.propertyList=t})))},t.prototype.bindIndentify=function(e){var t=this;e.children&&e.children.length>0?e.children.forEach((function(e){e.children&&e.children.length>0?t.bindIndentify(e):t.bindClick(e)})):this.bindClick(e)},t.prototype.bindClick=function(e){var t=this;"Imagery"==e.czmObject.xbsjType?"WebMapTileServiceImageryProvider"!=e.czmObject.xbsjImageryProvider.type&&"WebMapServiceImageryProvider"!=e.czmObject.xbsjImageryProvider.type||(-1!==e.czmObject.xbsjImageryProvider[e.czmObject.xbsjImageryProvider.type].url.indexOf("arcgis")?this.czmObjList.push(e.czmObject):this.identify.GetFeatureInfo(e.czmObject,this.view,"point",(function(n){t.title=e.czmObject.xbsjImageryProvider[e.czmObject.xbsjImageryProvider.type].layer,t.pin1.customProp=!0,t.showInfo=!0,t.propertyList=n}))):e.czmObject.xbsjType},t.prototype.close=function(){this.showInfo=!1},t.prototype.zoomTo=function(){var e=this.view.czm.viewer.dataSources.getByName("highLight")[0].entities;this.view.czm.viewer.flyTo(e)},t.prototype.switch=function(e){var t=this.view;console.log(this.czmObjList),"aqua"==e.srcElement.style.color?e.srcElement.style.color="":e.srcElement.style.color="aqua",t.epsplanet.allowClick=!t.epsplanet.allowClick,t.epsplanet.allowClick?(this.view.interaction.picking.enabled=!0,this.view.interaction.picking.hoverEnable=!0):(this.view.interaction.picking.enabled=!1,this.view.interaction.picking.hoverEnable=!1,this.identify.ClearHighLight())},t.prototype.test=function(){var e=this;this.identify.getLayers(this.view.sceneTree.$refs.layerlist.children[1].children[0].czmObject,this.view,(function(t){console.log(t),e.pin1.customProp=!0,e.showInfo=!0,e.propertyList=t}))},t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this),this.Init()},t.prototype.ngAfterViewInit=function(){e.prototype.ngAfterViewInit.call(this)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t}($),e.PlanetIdentifyComponent.ɵfac=function(t){return new(t||e.PlanetIdentifyComponent)(o.ɵɵdirectiveInject(ze))},e.PlanetIdentifyComponent.ɵcmp=o.ɵɵdefineComponent({type:e.PlanetIdentifyComponent,selectors:[["epsgis-planet-identify"]],hostAttrs:["title","识别"],hostVars:2,hostBindings:function(e,t){2&e&&o.ɵɵclassProp("jimu-widget-onscreen-icon",!0)},features:[o.ɵɵInheritDefinitionFeature],decls:15,vars:12,consts:[["title","识别",1,"jimu-widget-onscreen-icon"],["nz-icon","",3,"nzIconfont","click"],[1,"dialog",3,"hidden","ngStyle"],[1,"panel"],["nz-icon","","nzType","close","nzTheme","outline",2,"float","right",3,"click"],[3,"nzData","nzFrontPagination","nzShowPagination","nzTitle"],["basicTable",""],[4,"ngFor","ngForOf"],["nz-icon","","nzType","zoom-in","nzTheme","outline",3,"click"],[1,"arrow"]],template:function(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"i",1),o.ɵɵlistener("click",(function(e){return t.switch(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(2,"div",2),o.ɵɵelementStart(3,"div",3),o.ɵɵelementStart(4,"span"),o.ɵɵtext(5),o.ɵɵelementEnd(),o.ɵɵelementStart(6,"i",4),o.ɵɵlistener("click",(function(){return t.close()})),o.ɵɵelementEnd(),o.ɵɵelementStart(7,"nz-table",5,6),o.ɵɵelementStart(9,"tbody"),o.ɵɵtemplate(10,we,5,2,"tr",7),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"i",8),o.ɵɵlistener("click",(function(){return t.zoomTo()})),o.ɵɵelementEnd(),o.ɵɵelementStart(12,"span"),o.ɵɵtext(13,"缩放至"),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelement(14,"div",9),o.ɵɵelementEnd()),2&e){var n=o.ɵɵreference(8);o.ɵɵadvance(1),o.ɵɵproperty("nzIconfont","icon-epsgis-weibiaoti-"),o.ɵɵadvance(1),o.ɵɵproperty("hidden",!t.showInfo)("ngStyle",o.ɵɵpureFunction2(9,Me,t.winPos[0]-65+"px",t.winPos[3]+"px")),o.ɵɵadvance(3),o.ɵɵtextInterpolate(t.title),o.ɵɵadvance(2),o.ɵɵproperty("nzData",t.propertyList)("nzFrontPagination",!1)("nzShowPagination",!1)("nzTitle",null),o.ɵɵadvance(3),o.ɵɵproperty("ngForOf",n.data)}},directives:[a.NzIconDirective,S.ɵNzTransitionPatchDirective,t.NgStyle,w.NzTableComponent,w.NzTbodyComponent,t.NgForOf,w.NzTrDirective,w.NzTableCellDirective],styles:[".ant-table-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%], .ant-table-thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%], .ant-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%], .ant-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{padding:10px}  .ssmodal_content{overflow:overlay!important}.dialog[_ngcontent-%COMP%]{position:absolute;width:300px;min-height:60px;color:#000;border-radius:5px;cursor:pointer}.dialog[_ngcontent-%COMP%],   .ant-table-tbody>tr>td,   .ant-table-thead>tr>th{padding:5px}  tr.ant-table-row.ng-star-inserted:nth-child(odd){background-color:hsla(0,0%,66.3%,.6)}.arrow[_ngcontent-%COMP%]{margin-left:50px;width:0;height:0;border-top:10px solid #fff;border-left:10px solid transparent;border-right:10px solid transparent}.panel[_ngcontent-%COMP%]{background-color:#fff;padding:5px}.panel[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000}.panel[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#0ff}.panel[_ngcontent-%COMP%]   .ant-table-wrapper[_ngcontent-%COMP%]{max-height:350px;overflow:overlay}"]}),e.PlanetIdentifyComponent=j([r.ComponentRegister({uri:"epsgis-planet-identify",path:"epsplanet/components/identify",name:"PlanetIdentifyComponent"})],e.PlanetIdentifyComponent),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(e.PlanetIdentifyComponent,[{type:o.Component,args:[{selector:"epsgis-planet-identify",templateUrl:"./identify.component.html",styleUrls:["./identify.component.scss"],host:{"[class.jimu-widget-onscreen-icon]":"true",title:"识别"}}]}],(function(){return[{type:ze}]}),null);var be=[e.PlanetEarthComponent,e.PlanetLayerListComponent,e.PlanetLayerManagerComponent,e.PlanetStatusBarComponent,e.PlanetHomeComponent,e.PlanetLocationComponent,e.PlanetModeSwitchComponent,e.PlanetZoomComponent,e.PlanetBasemapGalleryComponent,e.PlanetIdentifyComponent],Pe=function(){};Pe.ɵmod=o.ɵɵdefineNgModule({type:Pe}),Pe.ɵinj=o.ɵɵdefineInjector({factory:function(e){return new(e||Pe)},imports:[[t.CommonModule,n.HttpClientModule,i.ReactiveFormsModule,i.FormsModule,l.NzInputModule,s.NzInputNumberModule,a.NzIconModule,c.NzTreeModule,p.NzTreeViewModule,u.NzPopoverModule,m.NzDividerModule,d.NzSelectModule,g.NzButtonModule,h.NzMenuModule,f.NzDropDownModule,y.NzSliderModule,v.NzGridModule,C.NzTabsModule,z.NzModalModule,w.NzTableModule,M.NzSwitchModule,b.NzToolTipModule,P.NzFormModule,r.EpsGisDirectivesModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&o.ɵɵsetNgModuleScope(Pe,{declarations:[e.PlanetEarthComponent,e.PlanetLayerListComponent,e.PlanetLayerManagerComponent,e.PlanetStatusBarComponent,e.PlanetHomeComponent,e.PlanetLocationComponent,e.PlanetModeSwitchComponent,e.PlanetZoomComponent,e.PlanetBasemapGalleryComponent,e.PlanetIdentifyComponent],imports:[t.CommonModule,n.HttpClientModule,i.ReactiveFormsModule,i.FormsModule,l.NzInputModule,s.NzInputNumberModule,a.NzIconModule,c.NzTreeModule,p.NzTreeViewModule,u.NzPopoverModule,m.NzDividerModule,d.NzSelectModule,g.NzButtonModule,h.NzMenuModule,f.NzDropDownModule,y.NzSliderModule,v.NzGridModule,C.NzTabsModule,z.NzModalModule,w.NzTableModule,M.NzSwitchModule,b.NzToolTipModule,P.NzFormModule,r.EpsGisDirectivesModule],exports:[e.PlanetEarthComponent,e.PlanetLayerListComponent,e.PlanetLayerManagerComponent,e.PlanetStatusBarComponent,e.PlanetHomeComponent,e.PlanetLocationComponent,e.PlanetModeSwitchComponent,e.PlanetZoomComponent,e.PlanetBasemapGalleryComponent,e.PlanetIdentifyComponent]}),("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(Pe,[{type:o.NgModule,args:[{declarations:be,imports:[t.CommonModule,n.HttpClientModule,i.ReactiveFormsModule,i.FormsModule,l.NzInputModule,s.NzInputNumberModule,a.NzIconModule,c.NzTreeModule,p.NzTreeViewModule,u.NzPopoverModule,m.NzDividerModule,d.NzSelectModule,g.NzButtonModule,h.NzMenuModule,f.NzDropDownModule,y.NzSliderModule,v.NzGridModule,C.NzTabsModule,z.NzModalModule,w.NzTableModule,M.NzSwitchModule,b.NzToolTipModule,P.NzFormModule,r.EpsGisDirectivesModule],exports:be,entryComponents:k(be)}]}],null,null),e.BasePlanetWidgetComponent=$,e.EpsGisForPlanetModule=Pe,e.Identify=ze,e.SceneTreeUtils=G,e.newXbsjFolderNode=V,e.newXbsjLayerNode=B,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=epsplanet.umd.min.js.map